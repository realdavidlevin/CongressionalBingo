<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>House Judiciary Bingo</title>
    
    <link rel="manifest" href="./manifest.json">
    <script src="https://www.youtube.com/static/playables/sdk/v1/yt-playables-sdk.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>

    <style>
        :root { --yt-red: #ff0000; --bg: #0f0f0f; --tile: #212121; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'Roboto', sans-serif; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* Layout: 40% Video (Top) / 60% Game (Bottom) */
        #video-section { 
            width: 100%; height: 40vh; background: #000; 
            display: flex; justify-content: center; align-items: center; 
            border-bottom: 2px solid #333; 
        }
        #yt-player { width: 100%; max-width: 711px; height: 100%; }

        #bingo-section { flex: 1; padding: 15px; display: flex; flex-direction: column; align-items: center; position: relative; }
        #grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; width: 100%; max-width: 450px; }
        
        .tile { 
            background: var(--tile); border: 1px solid #333; aspect-ratio: 1/1; 
            display: flex; align-items: center; justify-content: center; text-align: center;
            font-size: 10px; font-weight: bold; padding: 4px; cursor: pointer; 
            border-radius: 6px; transition: 0.3s;
        }
        
        /* Red Glowing Active State */
        .tile.active { 
            background: var(--yt-red) !important; 
            border-color: #fff; 
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.8); 
            transform: scale(0.96);
        }
        .tile.free { border-color: #555; color: #888; }

        /* BINGO! Popup */
        #bingo-modal { 
            display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: #fff; color: #000; padding: 30px 60px; border-radius: 60px;
            font-size: 44px; font-weight: 900; z-index: 1000; 
            box-shadow: 0 0 80px rgba(255,255,255,0.4);
            animation: bounceIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes bounceIn { 0% { scale: 0.2; opacity: 0; } 100% { scale: 1; opacity: 1; } }

        #canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
    </style>
</head>
<body>

    <div id="video-section">
        <div id="yt-player"></div>
    </div>

    <div id="bingo-section">
        <canvas id="canvas"></canvas>
        <div id="bingo-modal">BINGO! ðŸŽ†</div>
        <h2 style="font-size: 14px; margin: 10px 0; color: #777; letter-spacing: 1.5px;">JUDICIARY BUZZWORD BINGO</h2>
        <div id="grid"></div>
    </div>

    <script>
        const words = [
            "Rule of Law", "Weaponization", "Subpoena", "Facts", "DOJ", "January 6th", "Metadata", 
            "Gag Order", "Transparency", "Accountability", "Classified", "Evidence", "Oath", 
            "Grand Jury", "Immunity", "Indictment", "Privilege", "Due Process", "Oversight", 
            "Transcript", "Deposition", "Contempt", "Briefing", "Affidavit"
        ];

        let state = Array(25).fill(false);
        state[12] = true; 

        // --- YouTube Playables SDK Integration ---
        function onYouTubeIframeAPIReady() {
            // SDK Hook: First Frame Ready
            if (typeof ytgame !== 'undefined') {
                ytgame.game.firstFrameReady();
            }

            new YT.Player('yt-player', {
                videoId: 'EdHfPqCTOgs', // Official GOP Feed
                playerVars: { 
                    'autoplay': 1, 
                    'playsinline': 1, 
                    'origin': window.location.origin 
                },
                events: {
                    'onReady': onPlayerReady
                }
            });
        }

        function onPlayerReady(event) {
            // SDK Hook: Game Ready
            if (typeof ytgame !== 'undefined') {
                ytgame.game.gameReady();
            }
            event.target.playVideo();
        }

        // --- Grid Generation ---
        const grid = document.getElementById('grid');
        let wIdx = 0;
        for (let i = 0; i < 25; i++) {
            const tile = document.createElement('div');
            tile.className = 'tile';
            if (i === 12) {
                tile.innerText = "FREE SPACE";
                tile.classList.add('free', 'active');
            } else {
                tile.innerText = words[wIdx++];
                tile.onclick = () => {
                    tile.classList.toggle('active');
                    state[i] = !state[i];
                    if (checkBingo()) triggerCelebration();
                };
            }
            grid.appendChild(tile);
        }

        function checkBingo() {
            const wins = [[0,1,2,3,4],[5,6,7,8,9],[10,11,12,13,14],[15,16,17,18,19],[20,21,22,23,24],[0,5,10,15,20],[1,6,11,16,21],[2,7,12,17,22],[3,8,13,18,23],[4,9,14,19,24],[0,6,12,18,24],[4,8,12,16,20]];
            return wins.some(line => line.every(idx => state[idx]));
        }

        function triggerCelebration() {
            const modal = document.getElementById('bingo-modal');
            modal.style.display = 'block';
            burstConfetti();
            setTimeout(() => modal.style.display = 'none', 4000);
        }

        // --- Confetti Engine ---
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function burstConfetti() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            for(let i=0; i<150; i++) {
                particles.push({
                    x: canvas.width/2, y: canvas.height/2,
                    vx: (Math.random()-0.5)*18, vy: (Math.random()-0.5)*18,
                    size: Math.random()*6+2, 
                    color: `hsl(${Math.random()*360}, 80%, 60%)`, life: 1.0
                });
            }
            animate();
        }

        function animate() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            particles.forEach((p, i) => {
                p.x += p.vx; p.y += p.vy; p.vy += 0.2; p.life -= 0.01;
                ctx.globalAlpha = p.life;
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x, p.y, p.size, p.size);
                if(p.life <= 0) particles.splice(i, 1);
            });
            if(particles.length > 0) requestAnimationFrame(animate);
        }
    </script>
</body>
</html>
